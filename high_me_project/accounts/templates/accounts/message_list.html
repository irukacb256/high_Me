{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container py-4">
    <h2 class="mb-4 fw-bold">メッセージ</h2>

    <div class="list-group">
        {% for app in applications %}
        <a href="{% url 'worker_message_detail' app.id %}"
            class="list-group-item list-group-item-action p-3 border-0 border-bottom">
            <div class="d-flex align-items-center">
                <!-- 店舗画像/アイコン (プレースホルダー) -->
                <div class="flex-shrink-0 me-3">
                    <div class="bg-secondary rounded-circle d-flex align-items-center justify-content-center"
                        style="width: 50px; height: 50px; color: white; background-color: #adb5bd !important;">
                        <i class="fa-solid fa-store fa-lg"></i>
                    </div>
                </div>

                <!-- メッセージ概要 -->
                <div class="flex-grow-1 min-width-0">
                    <div class="d-flex justify-content-between align-items-baseline mb-1">
                        <h6 class="mb-0 fw-bold text-dark">{{ app.job_posting.template.store.store_name }}</h6>
                        <small class="text-muted ms-2" style="font-size: 0.75rem;">
                            {% if app.latest_message %}
                            {{ app.latest_message.created_at|date:"n月j日" }}
                            {% else %}
                            {{ app.applied_at|date:"n月j日" }}
                            {% endif %}
                        </small>
                    </div>
                    <p class="mb-0 text-muted small text-truncate" style="color: #6c757d;">
                        {% if app.latest_message %}
                        {{ app.latest_message.content|truncatechars:30 }}
                        {% else %}
                        まだメッセージはありません
                        {% endif %}
                    </p>
                </div>
            </div>
        </a>
        {% empty %}
        <div class="text-center py-5 text-muted">
            <i class="fa-regular fa-comments fa-3x mb-3"></i>
            <p>メッセージはありません</p>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}