{% extends 'Auth/signup_base.html' %}

{% block back_button %}
<a href="{% url 'setup_gender' %}" class="back-btn">＜</a>
{% endblock %}

{% block progress_bar %}
<div class="progress-segment active"></div>
<div class="progress-segment active"></div>
<div class="progress-segment active"></div>
<div class="progress-segment active"></div>
<div class="progress-segment "></div>
<div class="progress-segment "></div>
<div class="progress-segment "></div>
{% endblock %}

{% block title %}顔が映っている写真を登録する{% endblock %}

{% block form_content %}
<div style="text-align: center; margin-bottom: 30px;">
    <div id="preview"
        style="width:150px; height:150px; background:#f0f0f0; border-radius:50%; margin:0 auto 20px; display:flex; align-items:center; justify-content:center; overflow:hidden;">
        <i class="fa-solid fa-user" style="font-size:70px; color:#ccc;"></i>
    </div>
    <label for="id_photo"
        style="display:inline-block; background:var(--ios-blue); color:white; padding:12px 25px; border-radius:30px; cursor:pointer; font-size:15px;">顔写真を登録</label>
    <input class="form-input" type="file" id="id_photo" name="face_photo" accept="image/*" style="display:none;"
        onchange="previewImage(this)">
</div>
<div style="border:1px solid #eee; border-radius:12px; padding:20px; font-size:13px; color:#666; text-align:center;">
    <strong style="display:block; margin-bottom:5px; color:#333;">顔写真の確認事項</strong>
    店舗が本人かを確認するために使用します
    <div style="display:flex; flex-wrap:wrap; gap:5px; justify-content:center; margin-top:10px;">
        <span style="background:#f0f0f0; padding:4px 8px; border-radius:5px;">あなたのみ</span>
        <span style="background:#f0f0f0; padding:4px 8px; border-radius:5px;">正面向き</span>
    </div>
</div>
{% endblock %}


{% block footer_buttons %}
<a href="{% url 'setup_address' %}" class="btn-later">あとで</a>
<button type="submit" class="btn-next" disabled>次へ</button>
{% endblock %}

{% block extra_js %}
<script>
    function previewImage(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                var preview = document.getElementById('preview');
                // 既存のアイコンを隠すか、背景画像としてセットする
                preview.innerHTML = ''; // アイコンを削除
                preview.style.backgroundImage = 'url(' + e.target.result + ')';
                preview.style.backgroundSize = 'cover';
                preview.style.backgroundPosition = 'center';

                // 次へボタンを有効化
                document.querySelector('.btn-next').disabled = false;
            }
            reader.readAsDataURL(input.files[0]);
        }
    }
</script>
{% endblock %}