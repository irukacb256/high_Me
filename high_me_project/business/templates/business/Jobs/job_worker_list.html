{% extends 'business/Common/dashboard_base.html' %}

{% block content %}
<style>
    .header-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }

    .matching-title {
        font-size: 20px;
        font-weight: bold;
    }

    .btn-tool {
        background: white;
        border: 1px solid #ddd;
        padding: 8px 15px;
        border-radius: 4px;
        font-size: 13px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: bold;
    }

    .btn-dark {
        background: #333;
        color: white;
        border: none;
    }

    .info-banner {
        background: #f3eefc;
        padding: 12px 20px;
        border-radius: 8px;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
        color: #5a2ea6;
        font-size: 14px;
        font-weight: bold;
    }

    .worker-table {
        width: 100%;
        border-collapse: collapse;
        background: white;
        border-radius: 8px;
        overflow: hidden;
        border: 1px solid #eee;
    }

    .worker-table th {
        background: #f9f9f9;
        padding: 12px 15px;
        text-align: left;
        color: #888;
        font-size: 12px;
        border-bottom: 1px solid #eee;
        font-weight: normal;
    }

    .worker-table td {
        padding: 15px;
        border-bottom: 1px solid #eee;
        vertical-align: middle;
        font-size: 13px;
    }

    .worker-info-cell {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .worker-img {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: #eee;
        object-fit: cover;
    }

    .worker-name-box {
        display: flex;
        flex-direction: column;
        line-height: 1.4;
    }

    .name-kanji {
        color: #888;
        font-size: 13px;
    }

    .name-kana {
        color: #888;
        font-size: 11px;
    }

    .worker-meta {
        font-size: 12px;
        color: #888;
        margin-top: 2px;
    }

    .status-badge {
        background: #b2f2bb;
        color: #2b8a3e;
        padding: 4px 15px;
        border-radius: 20px;
        font-weight: bold;
        font-size: 12px;
        display: inline-block;
    }

    .tag-row {
        display: flex;
        gap: 5px;
        margin-top: 8px;
    }

    .skill-tag {
        font-size: 10px;
        padding: 2px 8px;
        border-radius: 4px;
        display: flex;
        align-items: center;
        gap: 3px;
    }

    .tag-orange {
        background: #fff4e6;
        color: #d9480f;
    }

    .tag-purple {
        background: #f3f0ff;
        color: #5f3dc4;
    }

    .back-link {
        color: #666;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 5px;
        margin-top: 30px;
        font-size: 14px;
    }

    /* „ÉÅ„Çß„ÉÅEÇØ„Éú„ÉÉ„ÇØ„Çπ */
    input[type="checkbox"] {
        width: 16px;
        height: 16px;
        cursor: pointer;
    }
</style>

<div class="header-row">
    <h1 class="matching-title">„Éû„ÉÉ„ÉÅ„É≥„Ç∞„Åó„Åü„ÉØ„Éº„Ç´„Éº ({{ matched_workers|length }}/{{ posting.count }}‰∫∫)</h1>
    <div style="display: flex; gap: 10px;">
        <button class="btn-tool" onclick="location.reload()">Êõ¥Êñ∞</button>
        <button class="btn-tool">CSV„ÉÄ„Ç¶„É≥„É≠„Éº„ÉÅE/button>
        <button class="btn-tool btn-dark"><i class="fa-regular fa-envelope"></i> ‰∏ÄÊã¨„Åß„É°„ÉÅEÇª„Éº„Ç∏„ÇíÈÄÅ„Çã</button>
    </div>
</div>

<div class="info-banner">
    <i class="fa-solid fa-bullhorn"></i> [„Åù„ÅE‰ªñ] „Éú„Çø„É≥„Åã„Çâ„ÉØ„Éº„Ç´„Éº„ÅÆÊ¨†Âã§„ÇíÂ†±Âëä„Åß„Åç„Çã„Çà„ÅÜ„Å´„Å™„Çä„Åæ„Åó„Åü
</div>

<table class="worker-table">
    <thead>
        <tr>
            <th style="width: 40px; text-align: center;"><input type="checkbox"></th>
            <th>„ÉØ„Éº„Ç´„Éº</th>
            <th>Áä∂ÊÖÅE/th>
            <th>ÈõªË©±</th>
            <th>„ÉÅ„Çß„ÉÅEÇØ„Ç§„É≥/„Ç¢„Ç¶„ÉÅE/th>
            <th>GoodÁéÅEÅEÁ®ºÂÉçÂõûÊï∞</th>
            <th>Êìç‰ΩÅE/th>
        </tr>
    </thead>
    <tbody>
        {% for match in matched_workers %}
        <tr>
            <td style="text-align: center;"><input type="checkbox"></td>
            <td>
                <div class="worker-info-cell">
                    <!-- È°îÂÅEÁúü„ÅEÂèçÊò† -->
                    {% if match.safe_profile and match.safe_profile.face_photo %}
                    <img src="{{ match.safe_profile.face_photo.url }}" class="worker-img">
                    {% else %}
                    <div class="worker-img"
                        style="display:flex; align-items:center; justify-content:center; background:#ffeb3b;">
                        <i class="fa-solid fa-face-smile" style="color:white; font-size:24px;"></i>
                    </div>
                    {% endif %}

                    <div class="worker-name-box">
                        <!-- „É™„É≥„ÇØ„ÇíËøΩÂä† -->
                        <a href="{% url 'biz_worker_detail' store.id match.worker.id %}"
                            style="text-decoration: none; color: inherit;">
                            {% if match.safe_profile %}
                            <span class="name-kanji">{{ match.safe_profile.last_name_kanji }} {{
                                match.safe_profile.first_name_kanji }}</span>
                            <span class="name-kana">{{ match.safe_profile.last_name_kana }} {{
                                match.safe_profile.first_name_kana }}</span>
                            <div class="worker-meta">
                                {{ match.worker_age }}Ê≠≥
                                {% if match.safe_profile.gender == 'Áî∑ÊÄß' %}Áî∑ÊÄß{% elif match.safe_profile.gender == 'Â•≥ÊÄß'
                                %}Â•≥ÊÄß{% else %}{{ match.safe_profile.gender }}{% endif %}
                            </div>
                            {% else %}
                            <span class="name-kanji">„Éó„É≠„Éï„Ç£„Éº„É´Êú™Ë®≠ÂÆÅE/span>
                            <div class="worker-meta">
                                {{ match.worker.username }}
                            </div>
                            {% endif %}
                        </a>
                    </div>
                </div>
                <!-- „Çπ„Ç≠„É´„Éê„ÉÉ„Ç∏ÅEàÂõ∫ÂÆö„Çµ„É≥„Éó„É´ÅEÅE-->
                <div class="tag-row">
                    <span class="skill-tag tag-orange"><i class="fa-solid fa-magnifying-glass"></i> „Éõ„ÅE„É´</span>
                    <span class="skill-tag tag-purple"><i class="fa-solid fa-utensils"></i> Ê¥ó„ÅÑÂ†¥</span>
                </div>
            </td>
            <td><span class="status-badge">Á¢∫ÂÆöÊ∏à„Åø</span></td>
            <td style="color:#aaa;">...</td>
            <td style="font-size:12px; line-height:1.5;">
                {% if match.attendance_at %}
                <span style="color: #2b8a3e; font-weight: bold;">„ÉÅ„Çß„ÉÅEÇØ„Ç§„É≥Ê∏ÅE/span>
                {% else %}
                <span style="color: #888;">Êú™„ÉÅ„Çß„ÉÅEÇØ„Ç§„É≥</span>
                {% endif %}
                <br>
                {% if match.leaving_at %}
                <span style="color: #2b8a3e; font-weight: bold;">„ÉÅ„Çß„ÉÅEÇØ„Ç¢„Ç¶„ÉàÊ∏ÅE/span>
                {% else %}
                <span style="color: #888;">Êú™„ÉÅ„Çß„ÉÅEÇØ„Ç¢„Ç¶„ÉÅE/span>
                {% endif %}
            </td>
            <td>
                <div style="display:flex; align-items:center; gap:8px;">
                    <span><i class="fa-regular fa-thumbs-up"></i> 100%</span>
                    <span><i class="fa-solid fa-briefcase"></i> 1ÂõÅE/span>
                </div>
            </td>
            <td>
                <div style="display: flex; gap: 8px;">
                    {% if match.room_id %}
                    <a href="{% url 'biz_message_detail' match.room_id %}" class="btn-tool"
                        style="padding: 8px 12px; text-decoration: none; color: inherit;">
                        <i class="fa-regular fa-envelope"></i>
                    </a>
                    {% else %}
                    <button class="btn-tool" disabled style="padding: 8px 12px; color: #ccc;">
                        <i class="fa-regular fa-envelope"></i>
                    </button>
                    {% endif %}
                    <button class="btn-tool">„Åù„ÅE‰ªÅE<i class="fa-solid fa-chevron-down"></i></button>
                </div>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="7" style="text-align: center; padding: 50px; color: #999;">
                „Éû„ÉÉ„ÉÅ„É≥„Ç∞„Åó„Åü„ÉØ„Éº„Ç´„Éº„ÅØ„Åæ„Å†„ÅÅEÅæ„Åõ„Çì
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<a href="{% url 'biz_job_posting_detail' store.id posting.id %}" class="back-link">
    <i class="fa-solid fa-chevron-left"></i> Ê±Ç‰∫∫Ë©≥Á¥∞„Å∏Êàª„ÇÅE
</a>

{% endblock %}
