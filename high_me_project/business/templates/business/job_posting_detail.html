{% extends 'business/dashboard_base.html' %}

{% block content %}
<style>
    .breadcrumb {
        font-size: 13px;
        color: #666;
        margin-bottom: 20px;
    }

    .breadcrumb a {
        color: #007AFF;
        text-decoration: none;
    }

    .page-title {
        font-size: 22px;
        font-weight: bold;
        margin-bottom: 5px;
    }

    .page-sub {
        font-size: 14px;
        color: #666;
        margin-bottom: 30px;
    }

    .detail-grid {
        display: flex;
        gap: 20px;
    }

    .detail-card {
        background: white;
        border: 1px solid #eee;
        border-radius: 8px;
        padding: 25px;
        flex: 1;
        display: flex;
        align-items: flex-start;
        gap: 20px;
        position: relative;
    }

    .icon-circle {
        width: 50px;
        height: 50px;
        background: #333;
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
    }

    .card-label {
        font-size: 13px;
        color: #666;
        margin-bottom: 5px;
    }

    .card-value {
        font-size: 18px;
        font-weight: bold;
    }

    .link-action {
        position: absolute;
        bottom: 15px;
        right: 20px;
        color: #007AFF;
        text-decoration: none;
        font-size: 14px;
        font-weight: bold;
    }

    .share-url-box {
        margin-top: 15px;
        background: #f5f5f5;
        padding: 10px;
        border-radius: 4px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 13px;
    }
</style>

<div class="breadcrumb">
    <a href="{% url 'biz_job_posting_list' store.id %}">求人一覧</a> ＞ 求人詳細
</div>

<h1 class="page-title">求人詳細</h1>
<p class="page-sub">作成した求人が表示されます。</p>

<div class="detail-grid">
    <!-- 公開設定カード -->
    <div class="detail-card">
        <div class="icon-circle"><i class="fa-solid fa-link"></i></div>
        <div>
            <div class="card-label">公開設定 <i class="fa-regular fa-question-circle"></i></div>
            <div class="card-value">一般公開</div>
            <div class="share-url-box">
                <span>https://link.timee.co.jp/YgNL</span>
                <i class="fa-regular fa-copy" style="cursor:pointer;"></i>
            </div>
        </div>
        <a href="#" class="link-action">公開設定を変更 ＞</a>
    </div>

    <!-- マッチングカード -->
    <div class="detail-card">
        <div class="icon-circle"><i class="fa-solid fa-user"></i></div>
        <div>
            <div class="card-label">マッチングしたワーカー</div>
            <div class="card-value">{{ posting.matched_count }} / {{ posting.recruitment_count }}人</div>
        </div>
        <a href="{% url 'biz_job_worker_list' store.id posting.id %}" class="link-action">ワーカーを確認 ＞</a>
    </div>
</div>

<div style="margin-top: 40px; display: grid; grid-template-columns: 2fr 1fr; gap: 20px;">
    <div style="background: white; padding: 30px; border-radius: 8px; border: 1px solid #eee;">
        <h3 style="margin-bottom: 25px; font-size: 18px; border-bottom: 2px solid #f0f0f0; padding-bottom: 10px;">
            求人内容の詳細</h3>

        <div class="detail-section">
            <h4 style="font-size: 14px; color: #888; margin-bottom: 10px;">基本情報</h4>
            <table style="width: 100%; font-size: 14px; border-collapse: collapse;">
                <tr>
                    <td style="padding: 10px 0; color: #666; width: 120px;">タイトル</td>
                    <td style="padding: 10px 0; font-weight: bold;">{{ posting.title }}</td>
                </tr>
                <tr>
                    <td style="padding: 10px 0; color: #666;">勤務日時</td>
                    <td style="padding: 10px 0; font-weight: bold;">
                        {{ posting.work_date|date:"Y/m/d (D)" }}<br>
                        {{ posting.start_time|time:"H:i" }} 〜 {{ posting.end_time|time:"H:i" }}
                    </td>
                </tr>
                <tr>
                    <td style="padding: 10px 0; color: #666;">休憩時間</td>
                    <td style="padding: 10px 0;">
                        {% if posting.break_start %}
                        {{ posting.break_start|time:"H:i" }} 〜 ({{ posting.break_duration }}分)
                        {% else %}
                        なし
                        {% endif %}
                    </td>
                </tr>
                <tr>
                    <td style="padding: 10px 0; color: #666;">募集人数</td>
                    <td style="padding: 10px 0;">{{ posting.recruitment_count }}人</td>
                </tr>
            </table>
        </div>

        <div class="detail-section" style="margin-top: 30px;">
            <h4 style="font-size: 14px; color: #888; margin-bottom: 10px;">業務・条件</h4>
            <div style="font-size: 14px; line-height: 1.6; background: #fafafa; padding: 15px; border-radius: 6px;">
                <p style="margin-bottom: 15px;"><strong>業務内容:</strong><br>{{
                    posting.work_content|default:posting.template.work_content|linebreaksbr }}</p>
                <p style="margin-bottom: 15px;"><strong>注意事項:</strong><br>{{ posting.template.precautions|linebreaksbr
                    }}</p>
                <p style="margin-bottom: 15px;"><strong>持ち物:</strong><br>{{ posting.template.belongings|default:"なし" }}
                </p>
                <p><strong>働くための条件:</strong><br>{{ posting.template.requirements|default:"なし" }}</p>
            </div>
        </div>
    </div>

    <div style="background: white; padding: 30px; border-radius: 8px; border: 1px solid #eee; height: fit-content;">
        <h3 style="margin-bottom: 20px; font-size: 16px;">待遇・環境</h3>
        <ul style="list-style: none; padding: 0; font-size: 13px;">
            <li style="padding: 8px 0; border-bottom: 1px solid #f0f0f0;">
                <span style="color: #888;">給与:</span> <span style="font-weight: bold;">時給 ¥{{ posting.hourly_wage
                    }}</span>
            </li>
            <li style="padding: 8px 0; border-bottom: 1px solid #f0f0f0;">
                <span style="color: #888;">交通費:</span> <span style="font-weight: bold;">¥{{ posting.transportation_fee
                    }}</span>
            </li>
            <li style="padding: 8px 0; border-bottom: 1px solid #f0f0f0;">
                <span style="color: #888;">喫煙環境:</span> {{ posting.template.get_smoking_prevention_display }}
                {% if posting.template.has_smoking_area %}<br><span
                    style="color: #ff3b30; font-size: 11px;">※喫煙エリアでの作業あり</span>{% endif %}
            </li>
            <li style="padding: 8px 0; border-bottom: 1px solid #f0f0f0;">
                <span style="color: #888;">必須資格:</span>
                {% if posting.template.requires_qualification %}
                {{ posting.template.qualification.name|default:"あり" }}
                {% if posting.template.qualification_notes %}<br><span style="font-size: 11px; color: #666;">{{
                    posting.template.qualification_notes }}</span>{% endif %}
                {% else %}
                なし
                {% endif %}
            </li>
        </ul>

        <div style="margin-top: 20px;">
            <div style="font-size: 12px; color: #888; margin-bottom: 5px;">公開範囲</div>
            <span class="privacy-tag"
                style="background: #eef6ff; color: #007AFF; padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: bold;">
                {{ posting.get_visibility_display }}
            </span>
        </div>
    </div>
</div>

{% endblock %}