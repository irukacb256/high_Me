@startuml QRの読み取りをする（退勤）

' 登場人物とコンポーネント
actor ワーカー as wo1
control 表示 as co1
entity 予定 as en1
boundary QR読み込み画面 as ch1
boundary 報酬確定修正依頼画面 as rc1
boundary 修正依頼_時間入力画面 as mr1 
boundary 修正依頼_休憩入力画面 as mr2 
boundary 修正依頼_理由選択画面 as mr3 
boundary 修正依頼_理由入力画面 as mr4 
boundary 修正依頼_確認画面 as mr5 
boundary 報酬の最終確認画面 as rl1
boundary 報酬確定画面 as rc2
entity 修正依頼データ as md1 

' 基本フロー 1-3 (QR読み取り～報酬確定/修正依頼選択画面)
co1 -> en1 : 予定を参照する
en1 --> co1 

' 基本フロー 1
co1 -> ch1 : QR読み込み画面を表示する

' 基本フロー 2
wo1 -> ch1 : 「OK」ボタンを押下する

' 基本フロー 3
ch1 -> rc1 : 報酬確定/修正依頼選択画面を表示する

' 基本フロー 4 (選択肢)
alt このまま報酬確定 (基本フロー)
    ' 基本フロー 4
    wo1 -> rc1 : 「このまま報酬確定」ボタンを押下する

    ' 基本フロー 5: システムは画面を表示する
    rc1 -> rc1 : 確定/キャンセルボタンを表示する 
    
    ' 基本フロー 6: ユーザーは「報酬を受け取る」ボタンを押下する
    ' 基本フロー 8: ユーザーは「確定する」ボタンを押下する
    ' -> ステップ5-8を合わせて「確定する」ボタン押下と解釈
    wo1 -> rc1 : 「確定する」ボタンを押下する 

    ' 基本フロー 9: システムは画面を表示する (最終確認画面)
    rc1 -> rl1 : 報酬の最終確認画面を表示する

    ' 基本フロー 10: ユーザーは「OK」ボタンを押下する
    wo1 -> rl1 : 「OK」ボタンを押下する

    ' 基本フロー 11: システムは画面を表示する (確定完了画面)
    rl1 -> rc2 : 報酬確定完了画面を表示する

else 残業時間の修正依頼を提出 (代替フロー 4-1)

    ' 代替フロー 4-1: 「残業時間の修正依頼を提出」ボタンを押下した場合
    wo1 -> rc1 : 「残業時間の修正依頼を提出」ボタンを押下する

    ' 代替フロー 4-1-1: システムは画面を表示する (業務時間入力画面)
    rc1 -> mr1 : 業務時間入力画面を表示する

    ' 代替フロー 4-1-2: ユーザーは「次へ」ボタンを押下する
    wo1 -> mr1 : 「次へ」ボタンを押下する

    ' 代替フロー 4-1-3: システムは画面を表示する (※時間入力のための再表示または次のステップへ)
    ' 4-1-4で入力を伴うため、画面の準備と解釈
    mr1 -> mr1 : 業務時間の入力欄を表示する 

    ' 代替フロー 4-1-4: 業務時間入力と「次へ」
    wo1 -> mr1 : 業務時間を入力し、「次へ」ボタンを押下する

    ' 代替フロー 4-1-5: システムは画面を表示する (休憩時間入力画面)
    mr1 -> mr2 : 休憩時間入力画面を表示する

    ' 代替フロー 4-1-6: 休憩時間入力と「次へ」
    wo1 -> mr2 : 休憩時間を入力し、「次へ」ボタンを押下する

    ' 代替フロー 4-1-7: システムは画面を表示する (理由選択画面)
    mr2 -> mr3 : 遅刻・早上がり理由選択画面を表示する

    ' 代替フロー 4-1-8: 理由の選択
    wo1 -> mr3 : 理由を選択し押下する

    ' 代替フロー 4-1-9: システムは画面を表示する (理由入力画面)
    mr3 -> mr4 : 修正依頼理由入力画面を表示する

    ' 代替フロー 4-1-10: 理由入力と「次へ」
    wo1 -> mr4 : 理由を入力し、「次へ」ボタンを押下する

    ' 代替フロー 4-1-11: システムは画面を表示する (最終確認画面)
    mr4 -> mr5 : 修正依頼の最終確認画面を表示する

    ' 代替フロー 4-1-12: チェックと「修正依頼を送信」
    wo1 -> mr5 : 確認事項にチェックを入れ、「修正依頼を送信」ボタンを押下する
    mr5 -> md1 : 修正依頼を登録する
    md1 --> mr5

    ' 代替フロー 4-1-13: システムは画面を表示する (完了画面)
    mr5 -> rc2 : 修正依頼完了画面を表示する

end

@enduml